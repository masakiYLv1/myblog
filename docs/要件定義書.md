# 要件定義書 (生成 AI と共に作成)

## **1. 要件定義書 概要**

本ドキュメントは、技術記事投稿プラットフォーム「myBlog」の **機能要件**・**非機能要件**を明確にし、

設計・実装の基準とすることを目的とする。

---

## **2. 前提条件（Assumptions）**

- フロントエンド：React / TypeScript / Vite
- UI：Chakra UI
- バックエンド：Supabase（Database / Auth / Storage）
- デプロイ：Firebase Hosting / GitHub Actions
- Markdown 形式による記事投稿を採用
- MVP（最小構成）を短期間で実装し、その後段階的に機能拡張する

---

## **3. 用語定義**

| 用語     | 意味                                   |
| -------- | -------------------------------------- |
| 記事     | ユーザーが Markdown で投稿する技術記事 |
| タグ     | 記事の分類に使用する文字列             |
| 下書き   | 非公開記事。本人のみ閲覧・編集可能     |
| 公開記事 | 全ユーザーが閲覧可能                   |
| RLS      | Supabase の Row Level Security         |

---

## **4. システム全体像（Overview）**

本サービスは以下の機能領域で構成される：

- **閲覧機能**：誰でも記事を閲覧できる
- **投稿機能**：ログインユーザーが記事を投稿・編集
- **タグ機能**：記事に複数タグを紐づける
- **ユーザー機能**：プロフィール表示
- **認証**：Supabase Auth によるログイン管理

---

## **5. 機能要件（Functional Requirements）**

---

### **5-1. 閲覧機能**

### ● 記事一覧画面（/）

- 公開記事を新着順に一覧表示する
- 記事カードには以下を表示
  - タイトル
  - タグ
  - 著者名
  - 投稿日時
- 下書きは表示しない

### ● 記事詳細画面（/articles/:id）

- Markdown を HTML に変換して表示
- 記事情報を表示（タイトル / 著者 / タグ / 投稿日時）
- URL に直接アクセスした場合も記事を表示
- 非公開（下書き）は本人以外アクセス不可（RLS）

### ● タグ一覧画面（/tags）

- 登録されているタグを一覧表示

### ● タグ別記事一覧（/tags/:tag）

- 指定タグが付いた公開記事のみ一覧表示

---

#### **5-2. 投稿機能（ログイン必須）**

### ● 新規記事投稿（/articles/new）

- title（必須）
- content（Markdown、必須）
- tags（複数選択可）
- 公開/下書きフラグ
- プレビュー表示が可能
- 投稿後は記事詳細へ遷移する

### ● 記事編集（/articles/:id/edit）

- 投稿者本人のみ編集可能
- タイトル、本文、タグ、公開フラグすべて編集可
- 更新後は記事詳細へ遷移

### ● 記事削除

- 投稿者本人のみ削除可能
- 論理削除 or 物理削除（後で設計で決定）

---

#### **5-3. ユーザー管理**

### ● プロフィール画面（/users/:id）

- ユーザー名
- 自己紹介（任意）
- 投稿した公開記事一覧

### ● ログイン / ログアウト

- Supabase Auth（Email + Password）

---

#### **5-4. 権限管理（RLS）**

- 下書き記事は投稿者のみ閲覧可能
- 投稿の編集・削除は投稿者本人のみ許可
- 公開記事は全ユーザー閲覧可能

---

## **6. 非機能要件（NFR）**

---

### **6-1. パフォーマンス**

- 記事一覧は 200ms 以内に読み込まれること
- Markdown の描画がストレスなく行えること
- 画像読み込みは Lazy Load を採用

---

### **6-2. セキュリティ**

- Supabase Auth で認証を行う
- RLS でユーザーごとに参照制限
- CSRF / XSS 対策（Markdown サニタイズ）

---

### **6-3. 可用性・保守性**

- React コンポーネントを atomic design 系で管理
- TypeScript を用いて型安全性を確保
- ER 図・API 仕様書・DB 定義書を Git 管理
- 開発と本番の環境変数を分離

---

#### **6-4. デプロイ**

- Firebase Hosting にデプロイ
- GitHub Actions で自動ビルド & デプロイ

---

#### **6-5. テスト**

- Jest + React Testing Library を採用
- 対象：
  - 記事投稿フォーム
  - 記事詳細の表示
  - 画面遷移
  - Supabase API のモックテスト

---

## **7. 外部インターフェース要件**

| 区分         | 要件                                    |
| ------------ | --------------------------------------- |
| ブラウザ対応 | Chrome / Edge / Firefox / Safari 最新版 |
| API          | Supabase REST / JS Client               |
| 外部サービス | Supabase Auth / Storage                 |

---

## **8. データ要件（後続：DB 定義書で詳細化）**

### 必要なテーブル

- users
- articles
- tags
- article_tag（多対多）

※ ER 図で後述

---

## **9. 画面一覧（Screen List）**

| 画面名             | URL                  | 説明               |
| ------------------ | -------------------- | ------------------ |
| トップ（記事一覧） | `/`                  | 公開記事一覧       |
| 記事詳細           | `/articles/:id`      | 記事表示           |
| 新規投稿           | `/articles/new`      | 投稿フォーム       |
| 記事編集           | `/articles/:id/edit` | 編集フォーム       |
| プロフィール       | `/users/:id`         | 投稿者情報         |
| タグ一覧           | `/tags`              | タグ一覧           |
| タグ別記事一覧     | `/tags/:name`        | タグごとの記事一覧 |
| ログイン           | `/login`             | 認証               |

---

## **10. MVP と拡張機能の境界**

### ◎ MVP（必須）

- Markdown 記事投稿
- 記事一覧 / 詳細
- タグ管理
- 下書き機能
- 認証
- プロフィール

### △ 拡張（Phase2 以降）

- 記事検索
- いいね
- コメント
- 下書きの自動保存
- OGP カード生成
- SNS シェアボタン

---

## **11. 成果物（Deliverables）**

- 要件定義書
- 概要設計書
- ER 図
- 画面遷移図
- ワイヤーフレーム
- DB 定義書
- API 仕様書
- myBlog（React + TS + Supabase）本体

---

## **12. リスクと制約**

- Supabase の無料枠を超える可能性
- Markdown による XSS リスク
- ユーザーが大量に投稿した際のパフォーマンス要件
- デプロイ先の利用可能容量（Firebase Hosting）

---

## **13. 承認**

- 作成者：
- 承認者：
- 作成日：
